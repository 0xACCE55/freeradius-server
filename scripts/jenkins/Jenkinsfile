/*
 *  Build FreeRADIUS packages for common Linux distributions.
 *  Function definitions are pulled in from Jenkinsfile.defs so
 *  that they can be used in other Jenkinsfiles.
 */

node {
	cleanWs(patterns: [[pattern: '**/*.deb , **/*.changes , **/*.buildinfo , **/*.rpm', type: 'INCLUDE']])
	checkout scm

	def fr = load "scripts/jenkins/Jenkinsfile.defs"
	fr.genBuildNumber()

	parallel fr.buildClosures(platforms, scm.branches, scm.userRemoteConfigs)

	archiveArtifacts artifacts: artifacts, onlyIfSuccessful: true
	cleanWs()
}
